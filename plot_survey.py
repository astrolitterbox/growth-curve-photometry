# -*- coding: utf-8 -*-
"""
Created on Tue Feb 21 19:18:52 2012

@author: astrolitterbox
"""
import numpy as np
#import db
no display name and no $DISPLAY environment variable
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> ssh simona@login^C
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> 
simona@torridon:/work2/simona/growth curve photometry> lt
total 109672
-rw-r--r-- 1 simona galaxies      328 2012-03-26 15:26 readFieldFiles.py
-rw-r--r-- 1 simona galaxies     1904 2012-04-02 12:51 Interpol.py~
-rw-r--r-- 1 simona galaxies     1927 2012-04-02 12:51 Interpol.py
-rw-r--r-- 1 simona galaxies     1126 2012-04-02 14:04 Interpol.pyc
-rw-r--r-- 1 simona galaxies     3938 2012-04-02 16:56 photometry.pyc
-rw-r--r-- 1 simona galaxies     2262 2012-04-02 17:02 getImages.py~
-rw-r--r-- 1 simona galaxies     2262 2012-04-02 17:02 getImages.py
-rw-r--r-- 1 simona galaxies      321 2012-04-03 14:16 normalise_image.py~
-rw-r--r-- 1 simona galaxies      351 2012-04-03 14:16 normalise_image.py
-rw-r--r-- 1 simona galaxies     5002 2012-04-12 15:42 photometry.py~
-rw-r--r-- 1 simona galaxies     5003 2012-04-12 15:42 photometry.py
-rw-r--r-- 1 simona galaxies     3112 2012-04-16 12:17 sqlcl.py
-rw-r--r-- 1 simona galaxies     1387 2012-04-16 12:17 sdss_photo_check.py
-rw-r--r-- 1 simona galaxies     1502 2012-04-16 14:42 sdss_photo_check.pyc
-rw-r--r-- 1 simona galaxies     3789 2012-04-16 14:42 sqlcl.pyc
-rw-r--r-- 1 simona galaxies     3556 2012-04-17 14:37 sgolay2d.py~
-rw-r--r-- 1 simona galaxies     3562 2012-04-17 14:37 sgolay2d.py
-rw-r--r-- 1 simona galaxies     2814 2012-04-17 14:37 sgolay2d.pyc
-rw-r--r-- 1 simona galaxies 24399360 2012-04-17 15:30 fit_sky_row.fits
-rw-r--r-- 1 simona galaxies    14672 2012-04-24 11:17 _abcoll.py
-rw-r--r-- 1 simona galaxies    25403 2012-04-24 11:17 collections.py
drwxr-xr-x 2 simona galaxies     4096 2012-04-24 11:17 collections
-rw-r--r-- 1 simona galaxies   975872 2012-04-26 16:42 mothersample
-rw-r--r-- 1 simona galaxies    12463 2012-05-14 11:41 master.py.orig
-rw-r--r-- 1 simona galaxies     5727 2012-05-15 13:10 circle.py~
-rw-r--r-- 1 simona galaxies     4350 2012-05-15 13:10 circle.pyc
-rw-r--r-- 1 simona galaxies    13159 2012-05-15 13:39 master.py~
-rw-r--r-- 1 simona galaxies    13164 2012-05-15 13:39 master.py
-rw-r--r-- 1 simona galaxies    11292 2012-05-15 13:39 master.pyc
-rw-r--r-- 1 simona galaxies  2004480 2012-05-15 13:39 input.fits
-rw-r--r-- 1 simona galaxies    14060 2012-07-20 14:54 draw_ellipses.py~
-rw-r--r-- 1 simona galaxies    14063 2012-07-20 14:54 draw_ellipses.py
-rw-r--r-- 1 simona galaxies     9321 2012-08-08 11:07 circle.py
-rw-r--r-- 1 simona galaxies      446 2012-08-08 13:42 findFileList.py~
-rw-r--r-- 1 simona galaxies      446 2012-08-08 13:42 findFileList.py
-rw-r--r-- 1 simona galaxies    25571 2012-08-13 11:38 collections.pyc
-rw-r--r-- 1 simona galaxies    44100 2012-08-13 15:29 inputIndices.txt
-rw-r--r-- 1 simona galaxies    18697 2012-08-14 13:14 ellipse_photometry.py.orig
-rw-r--r-- 1 simona galaxies     2792 2012-08-14 13:16 ellipse.py.orig
-rw-r--r-- 1 simona galaxies     1418 2012-08-15 16:21 getTSFieldParameters.py~
-rw-r--r-- 1 simona galaxies     1418 2012-08-15 16:26 getTSFieldParameters.py
drwxr-xr-x 2 simona galaxies     4096 2012-08-15 17:28 lucie
-rw-r--r-- 1 simona galaxies     1434 2012-08-16 13:11 getTSFieldParameters.pyc
-rw-r--r-- 1 simona galaxies     8709 2012-08-17 13:54 atlas_magnitudes.txt~
-rw-r--r-- 1 simona galaxies     8716 2012-08-17 13:54 atlas_magnitudes.txt
-rw-r--r-- 1 simona galaxies     3019 2012-08-17 13:55 readAtlas.py~
-rw-r--r-- 1 simona galaxies     3025 2012-08-17 13:55 readAtlas.py
-rw-r--r-- 1 simona galaxies     2035 2012-08-17 13:56 readAtlas.pyc
-rw-r--r-- 1 simona galaxies 24399360 2012-08-17 16:14 ellipseMask95.fits
-rw-r--r-- 1 simona galaxies    13992 2012-08-17 17:06 SDSS_skies.txt~
-rw-r--r-- 1 simona galaxies    13992 2012-08-17 17:06 SDSS_skies.txt
-rw-r--r-- 1 simona galaxies       39 2012-08-17 17:08 getSDSSHeaderInfo.py~
-rw-r--r-- 1 simona galaxies      619 2012-08-17 17:08 getSDSSHeaderInfo.py
-rw-r--r-- 1 simona galaxies     5506 2012-08-17 17:55 db.py~
-rw-r--r-- 1 simona galaxies     5550 2012-08-17 17:55 db.py
-rw-r--r-- 1 simona galaxies     5803 2012-08-17 17:55 db.pyc
-rw-r--r-- 1 simona galaxies    14285 2012-08-17 18:49 img_scale.py~
-rw-r--r-- 1 simona galaxies    14286 2012-08-17 18:49 img_scale.py
-rw-r--r-- 1 simona galaxies    11997 2012-08-17 18:49 img_scale.pyc
-rw-r--r-- 1 simona galaxies     1248 2012-08-17 19:16 wrong_filled_files.txt~
-rw-r--r-- 1 simona galaxies     1265 2012-08-17 19:16 wrong_filled_files.txt
-rw-r--r-- 1 simona galaxies     5056 2012-08-17 20:57 photometry_plots.py~
-rw-r--r-- 1 simona galaxies      165 2012-08-17 21:27 gc_photometry.csv~
-rw-r--r-- 1 simona galaxies     4419 2012-08-17 21:29 gc_photometry.csv
-rw-r--r-- 1 simona galaxies      495 2012-08-19 13:40 imtools.py
-rw-r--r-- 1 simona galaxies     4479 2012-08-19 13:43 photometry_plots.py
-rw-r--r-- 1 simona galaxies      610 2012-08-19 16:25 imtools.pyc
-rw-r--r-- 1 simona galaxies    57186 2012-08-19 16:38 log.txt
-rw-r--r-- 1 simona galaxies    11011 2012-08-22 09:34 fill_tree.py
-rw-r--r-- 1 simona galaxies 12208320 2012-08-22 13:31 filled_a.fits
-rw-r--r-- 1 simona galaxies 12208320 2012-08-22 13:43 filled_b.fits
-rw-r--r-- 1 simona galaxies 12202560 2012-08-22 14:05 filled_1.fits
-rw-r--r-- 1 simona galaxies 12202560 2012-08-22 14:27 filled_202.fits
-rw-r--r-- 1 simona galaxies     6592 2012-08-22 15:31 inpaint.py~
-rw-r--r-- 1 simona galaxies     5586 2012-08-22 15:57 fill.py~
-rw-r--r-- 1 simona galaxies     2759 2012-08-22 16:56 gal_params.py~
-rw-r--r-- 1 simona galaxies     2759 2012-08-22 16:56 gal_params.py
-rw-r--r-- 1 simona galaxies     4925 2012-08-24 14:02 utils.py~
drwxr-xr-x 9 simona galaxies     4096 2012-08-24 14:09 img
-rw-r--r-- 1 simona galaxies     3597 2012-08-24 14:21 ellipse.py~
-rw-r--r-- 1 simona galaxies     3599 2012-08-24 14:21 ellipse.py
-rw-r--r-- 1 simona galaxies     3515 2012-08-24 14:27 ellipse.pyc
-rw-r--r-- 1 simona galaxies     3041 2012-08-24 14:43 plot_survey.py~
-rw-r--r-- 1 simona galaxies     3042 2012-08-24 14:43 plot_survey.py
-rw-r--r-- 1 simona galaxies     1135 2012-08-24 14:45 plotGrowthCurve.py~
-rw-r--r-- 1 simona galaxies     1135 2012-08-24 14:45 plotGrowthCurve.py
-rw-r--r-- 1 simona galaxies     3810 2012-08-24 14:46 plot_survey.pyc
-rw-r--r-- 1 simona galaxies      891 2012-08-24 14:46 plotGrowthCurve.pyc
-rw-r--r-- 1 simona galaxies    19943 2012-08-24 16:02 ellipse_photometry.py~
-rw-r--r-- 1 simona galaxies    20003 2012-08-25 20:28 ellipse_photometry.py
-rw-r--r-- 1 simona galaxies     5614 2012-08-25 20:28 fill.py
-rw-r--r-- 1 simona galaxies     4926 2012-08-25 20:28 utils.py
-rw-r--r-- 1 simona galaxies     3186 2012-08-25 20:28 shift.py
-rw-r--r-- 1 simona galaxies     7169 2012-08-25 20:28 inpaint.py
-rw-r--r-- 1 simona galaxies     6747 2012-08-25 20:29 utils.pyc
-rw-r--r-- 1 simona galaxies     6881 2012-08-25 20:29 inpaint.pyc
-rw-r--r-- 1 simona galaxies    14791 2012-08-25 20:29 ellipse_photometry.pyc
-rw------- 1 simona galaxies 10858543 2012-08-25 21:11 nohup.out
simona@torridon:/work2/simona/growth curve photometry> startx
xauth:  creating new authority file /home/simona/.serverauth.3846
xauth: (stdin):2:  unknown command "e844196e93c59cfcd9824f3d3a17380d"


Fatal server error:
	Server is already active for display 0
	        If this server is no longer running, remove /tmp/.X0-lock
		        and start again.


			Please consult the The X.Org Foundation support 
			         at http://wiki.x.org
				  for help. 

				  ^C
				  simona@torridon:/work2/simona/growth curve photometry> ^C
				  simona@torridon:/work2/simona/growth curve photometry> echo $DISPLAY

				  simona@torridon:/work2/simona/growth curve photometry> set
				  set                 set_default_volume  setfattr            setJava             setleds             setserial           setterm             
				  setarch             setfacl             setfont             setkeycodes         setmetamode         setsid              setxkbmap           
				  simona@torridon:/work2/simona/growth curve photometry> export DISPLAY=0
				  simona@torridon:/work2/simona/growth curve photometry> echo $DISPLAY
				  0
				  simona@torridon:/work2/simona/growth curve photometry> python ellipse_photometry.py
				  filledFilename ../data/filled2/fpC-004152-r6-0064.fits
				  0 a
				  /home/simona/lib/lib64/python2.6/site-packages/astLib/astWCS.py:124: DeprecationWarning: The ascardlist function is deprecated and may be removed in a future version.  Use the ascard attribute instead.
				    cardlist=newHead.ascardlist()
				    centerCoords ('0.3324108123', '34.525669097')
				    pixCoords [1357.3683239099867, 644.81077071152617]
				    centerCoords ('0.3324108123', '34.525669097')
				    pixCoords [1357.3683239099867, 644.81077071152617]
				    centerCoords ('0.3324108123', '34.525669097')
				    pixCoords [1357.3683239099867, 644.81077071152617]
				    2258229.69678 squared distance to origin
				    select PA from nadine where califa_id = 1 order by rowid asc
				    select ba from nadine where califa_id = 1 order by rowid asc
				    starting to calculate sky gradient...
				    isoA 179
				    (644.81077071152617, 1357.3683239099867) 1489 2048
				    227 644 start and end
				    0.00018514729179 gradient
				    108.431365146 skyMean
				    CIRCULAR APERTURE
				    limit reached! 234
				    STR -- http://das.sdss.org/imaging/4152/648/calibChunks/6/tsField-004152-6-648-0064.fit
				    opened
				    -24.1188 0.23543 1.10745546704 -------------------
				    -24.1188 0.23543 1.10745546704 tsparams
				    full magnitude 13.3869622247
				    ELLIPTICAL APERTURE
				    limit reached! 253
				    54359 ***************************************
				    t 798979.422029 o 798101.69015
				    STR -- http://das.sdss.org/imaging/4152/648/calibChunks/6/tsField-004152-6-648-0064.fit
				    opened
				    -24.1188 0.23543 1.10745546704 -------------------
				    -24.1188 0.23543 1.10745546704 tsparams
				    full magnitude 13.4308549603
				    Traceback (most recent call last):
					      File "ellipse_photometry.py", line 503, in <module>
					          main()
						    File "ellipse_photometry.py", line 487, in main
						        output = Photometry.calculateGrowthCurve(listFile, dataDir, i)
							  File "ellipse_photometry.py", line 434, in calculateGrowthCurve
							      plotGrowthCurve.plotGrowthCurve(fluxData, CALIFA_ID)
							        File "/work2/simona/growth curve photometry/plotGrowthCurve.py", line 12, in plotGrowthCurve
								    graph.plotScatter([cumulativeFluxData], CALIFA_ID+"cumulative_Flux", plot.PlotTitles("Sky subtracted cumulativeFlux", "distance", "Flux"))
								      File "/work2/simona/growth curve photometry/plot_survey.py", line 77, in plotScatter
								          s = plt.figure()
									    File "/home/simona/lib64/python2.6/site-packages/matplotlib/pyplot.py", line 343, in figure
									        **kwargs)
										  File "/home/simona/lib64/python2.6/site-packages/matplotlib/backends/backend_tkagg.py", line 80, in new_figure_manager
										      window = Tk.Tk()
										        File "/usr/lib64/python2.6/lib-tk/Tkinter.py", line 1643, in __init__
											    self.tk = _tkinter.create(screenName, baseName, className, interactive, wantobjects, useTk, sync, use)
											    _tkinter.TclError: couldn't connect to display "0"
											    simona@torridon:/work2/simona/growth curve photometry> du -h ../data/filled2/
											    6.3G    ../data/filled2/
											    simona@torridon:/work2/simona/growth curve photometry> ls
											    _abcoll.py             db.pyc                      ellipse.py.orig   gal_params.py             img               Interpol.py     normalise_image.py    plot_survey.py~       sgolay2d.py~
											    atlas_magnitudes.txt   draw_ellipses.py            filled_1.fits     gal_params.py~            img_scale.py      Interpol.py~    normalise_image.py~   plot_survey.pyc       sgolay2d.pyc
											    atlas_magnitudes.txt~  draw_ellipses.py~           filled_202.fits   gc_photometry.csv         img_scale.py~     Interpol.pyc    photometry_plots.py   readAtlas.py          shift.py
											    circle.py              ellipseMask95.fits          filled_a.fits     gc_photometry.csv~        img_scale.pyc     log.txt         photometry_plots.py~  readAtlas.py~         sqlcl.py
											    circle.py~             ellipse_photometry.py       filled_b.fits     getImages.py              imtools.py        lucie           photometry.py         readAtlas.pyc         sqlcl.pyc
											    circle.pyc             ellipse_photometry.py~      fill.py           getImages.py~             imtools.pyc       master.py       photometry.py~        readFieldFiles.py     utils.py
											    collections            ellipse_photometry.pyc      fill.py~          getSDSSHeaderInfo.py      inpaint.py        master.py~      photometry.pyc        sdss_photo_check.py   utils.py~
											    collections.py         ellipse_photometry.py.orig  fill_tree.py      getSDSSHeaderInfo.py~     inpaint.py~       master.pyc      plotGrowthCurve.py    sdss_photo_check.pyc  utils.pyc
											    collections.pyc        ellipse.py                  findFileList.py   getTSFieldParameters.py   inpaint.pyc       master.py.orig  plotGrowthCurve.py~   SDSS_skies.txt        wrong_filled_files.txt
											    db.py                  ellipse.py~                 findFileList.py~  getTSFieldParameters.py~  input.fits        mothersample    plotGrowthCurve.pyc   SDSS_skies.txt~       wrong_filled_files.txt~
											    db.py~                 ellipse.pyc                 fit_sky_row.fits  getTSFieldParameters.pyc  inputIndices.txt  nohup.out       plot_survey.py        sgolay2d.py
											    simona@torridon:/work2/simona/growth curve photometry> exit
											    simona@torridon:/work2/simona/growth curve photometry> exit
											    torridon /home/simona> logout
											    Connection to torridon closed.
											    simona@login:~> ssh -X torridon
											    Password: 
											    Last login: Sat Aug 25 18:18:28 2012 from login-int.aip.de
											    Have a lot of fun...
											    torridon /home/simona> bash
											    simona@torridon:~> ls ../data/filled2 | wc -l
											    ls: cannot access ../data/filled2: No such file or directory
											    0
											    simona@torridon:~> cd /work2/simona/growth\ curve\ photometry/
											    # -*- coding: utf-8 -*-
											    """
											    Created on Tue Feb 21 19:18:52 2012

											    @author: astrolitterbox
											    """
											    import numpy as np
											    #import db

											    import matplotlib as mpl
											    mpl.use('Agg')
import matplotlib.pyplot as plt
import matplotlib.font_manager
import numpy as np



x1,x2,n,m,b = 0.,300.,1000,1.,0.
x = np.r_[x1:x2:n*1j]  


class PlotTitles:
    def __init__(self, title, xlabel, ylabel):
        self.title = title
        self.xlabel = xlabel
        self.ylabel = ylabel


class GraphData:
    def __init__(self, data, colour, legend):
        self.data = data
        self.colour = colour
        self.legend = legend

class Plots:
    imgDir = './img/plots/'        
    def plotLogHist(self, graphDataList, filename, plotTitles, bins, *args):
      bins=10**np.arange(*bins)     
      s = plt.figure()
      ax = s.add_subplot(111)      
      try:
        args[0]
      except IndexError:
          print 'blah'
      else:  
          v = list(args[0])
          ax.axis(v)
      prop = matplotlib.font_manager.FontProperties(size=8)     
      for gd in graphDataList:
          p1 = plt.hist((gd.data), color=gd.colour, bins = bins, histtype='barstacked', alpha=0.75)    
          print gd.legend            
          #plt.legend([p1], list(gd.legend), loc=0, markerscale=10, fancybox=True, labelspacing = 0.2, prop=prop, shadow=True)
      plt.title(plotTitles.title)
      plt.xlabel = plotTitles.xlabel
      plt.xscale('log')
      plt.ylabel = plotTitles.ylabel
      plt.savefig(self.imgDir+filename)

    def plotHist(self, graphDataList, filename, plotTitles, bins, *args):
      s = plt.figure()
      ax = s.add_subplot(111)
      try:
        args[0]
      except IndexError:
          print 'blah'
      else:  
          v = list(args[0])
          ax.axis(v)
      prop = matplotlib.font_manager.FontProperties(size=8)     
      for gd in graphDataList:
          p1 = plt.hist((gd.data), color=gd.colour, bins = bins, histtype='barstacked', alpha=0.75)    
          print gd.legend            
          #plt.legend([p1], list(gd.legend), loc=0, markerscale=10, fancybox=True, labelspacing = 0.2, prop=prop, shadow=True)
      plt.title(plotTitles.title)
      plt.xlabel = plotTitles.xlabel
      plt.ylabel = plotTitles.ylabel
      plt.savefig(self.imgDir+filename)
    
    def plotScatter(self, graphDataList, filename, plotTitles, *args):
      s = plt.figure()
      ax = s.add_subplot(111)
      try:
        args[0]
      except IndexError:
          print 'blah'
      else:  
          v = list(args[0])
          ax.axis(v)

      prop = matplotlib.font_manager.FontProperties(size=8)     
      for gd in graphDataList:
          p1 = ax.plot(gd.data[0], gd.data[1], '.', markersize=2, color=gd.colour, mec=gd.colour, alpha = 0.9) 
          #plt.legend([p1[0]], gd.legend,  loc=0, markerscale=1, fancybox=True, labelspacing = 0.2, prop=prop, shadow=True)
      #plt.plot(x, m*x + b, color='r', alpha = 0.6)
      plt.title(plotTitles.title)
      plt.xlabel = plotTitles.xlabel
      plt.ylabel = plotTitles.ylabel
      plt.savefig(self.imgDir+filename)
